name: Build and Deploy vite front end

on:
    push:
        branches: [ main ]

permissions: 
    contents: write

jobs:
    build:
        name: Compiling files
        runs-on: ubuntu-latest

        steps:
        # Step 1: Checkout the code
        - name: Checkout repository
          uses: actions/checkout@v3

        - name: Setup Node.JS
          uses: actions/setup-node@v3
            
        - name: Install dependencies]
          working-directory: pages/FrontEnd
          run: npm install

        - name: Build
          working-directory: pages/FrontEnd
          run: npm run build

        - name: Deploy
          if: success()
          run: |
            rm -rf pages/FrontEnd
            git config --global user.name "GitHub Actions"
            git config --global user.email "actions@github.com"
            git add pages/build/* -f
            git commit -m "Deploy Vite app to production branch"
            git push origin HEAD:production
            
              
        
